<h:panelGrid width="100%" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:s="http://jboss.com/products/seam/taglib"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:a4j="http://richfaces.org/a4j">
	<h1>Solicitações de Mudanças</h1>


	<div class="actionButtons">
		<s:button id="novaSolicitacao" value="Criar Nova"
			propagation="join"
			view="/view/solicitacoes/SolicitacaomudancaEdit.xhtml"
			includePageParams="false">
			<f:param name="statusmudancaId" value="1" />
			<f:param name="usuarioId" value="#{loggedUser.id}" />
			<f:param name="projetoId" value="#{projetoId}" />
		</s:button>
	</div>
	<h:outputText rendered="#{projeto.solicitacaomudancas.size() == 0}}"
		style="margin-top:10px"
		value="Até o momento nenhuma solicitação de mudança foi aberta para este projeto ..." />
	<a4j:outputPanel id="mudancasPanel" ajaxRendered="false">
		<a4j:repeat value="#{projeto.solicitacaomudancas}" var="_s"
			rendered="#{projeto.solicitacaomudancas.size() > 0}">
			<rich:simpleTogglePanel switchType="ajax" opened="false"
				ajaxSingle="true">
				<f:facet name="header">#{_s.titulo} - #{_s.statusmudanca.nome}"</f:facet>

				<h:panelGrid columns="2" columnClasses="sameWidth,sameWidth">
					<f:facet name="header">
						<h2>#{_s.titulo}</h2>
					</f:facet>

					<h:panelGrid columns="2" columnClasses="top,top">

						<h:panelGrid>
							<f:facet name="header">Descrição da mudança</f:facet>
							<p>#{_s.descricao}</p>
						</h:panelGrid>

						<h:panelGrid>
							<f:facet name="header">Justificativa da Aprovação</f:facet>
							<p>#{_s.justificativa}</p>
						</h:panelGrid>

					</h:panelGrid>

					<h:panelGrid columns="2" columnClasses="label,value,label,value">

						<h:outputText value="Solicitante:" />
						<h:outputText value="#{_s.usuario.nome}" />

						<h:outputText value="Data Solicitada:" />
						<h:outputText value="#{_s.dataabertura}" />

						<h:outputText value="Status da Solicitação:" />
						<h:outputText value="#{_s.statusmudanca.nome}" />

						<h:outputText value="Data Fechamento:" />
						<h:outputText value="#{_s.datafechamento}" />
					</h:panelGrid>
				</h:panelGrid>
				<div class="actionButtons">
					<s:button view="/view/solicitacoes/SolicitacaomudancaEdit.xhtml"
						value="Aprovar Solicitação" propagation="none"
						id="solicitacaomudancaAprovado"
						rendered="#{loggedUser.gp &amp;&amp; _s.statusmudanca.id == 1 }">
						<f:param name="solicitacaomudancaId"
							value="#{_s.id}" />
						<f:param name="statusmudancaId" value="2" />
						<f:param name="usuarioId" value="#{loggedUser.id}" />
						<f:param name="projetoId"
							value="#{_s.projeto.id}" />
					</s:button>
					<s:button view="/view/solicitacoes/SolicitacaomudancaEdit.xhtml"
						value="Reprovar Solicitação" propagation="none"
						id="solicitacaomudancaReprovado"
						rendered="#{loggedUser.gp &amp;&amp; _s.statusmudanca.id == 1}">
						<f:param name="solicitacaomudancaId"
							value="#{_s.id}" />
						<f:param name="statusmudancaId" value="3" />
						<f:param name="usuarioId" value="#{loggedUser.id}" />
						<f:param name="projetoId"
							value="#{_s.projeto.id}" />
					</s:button>
				</div>
			</rich:simpleTogglePanel>
		</a4j:repeat>
	</a4j:outputPanel>
</h:panelGrid>